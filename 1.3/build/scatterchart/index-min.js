/*! kcharts - v1.3 - 2014-01-07 9:15:56 PM
* Copyright (c) 2014 数据可视化小组; Licensed  */
KISSY.add("gallery/kcharts/1.3/scatterchart/theme",function(){var l="{COLOR}",t={"ks-chart-default":{title:{content:"",css:{"text-align":"center","font-size":"16px","font-weight":"bold",color:"#666"},isShow:!0},subTitle:{content:"",css:{"text-align":"center","font-size":"12px",color:"#666"},isShow:!0},points:{attr:{stroke:"#fff",r:4,"stroke-width":1.5,fill:l},hoverAttr:{stroke:"#fff",r:5,fill:l,"stroke-width":0}},xGrids:{css:{color:"#eee"}},yGrids:{css:{color:"#eee"}},yAxis:{css:{color:"#ccc"}},xAxis:{css:{color:"#ccc"}},xLabels:{css:{color:"#666","font-size":"12px"}},yLabels:{css:{color:"#666","font-size":"12px"}},tip:{css:{border:"1px solid {COLOR}"}}},"ks-chart-analytiks":{title:{content:"",css:{"text-align":"center","font-size":"16px","font-weight":"bold",color:"#666"},isShow:!0},subTitle:{content:"",css:{"text-align":"center","font-size":"12px",color:"#666"},isShow:!0},points:{attr:{stroke:"#fff",r:4,"stroke-width":1.5,fill:l},hoverAttr:{stroke:"#fff",r:5,fill:l,"stroke-width":0}},xGrids:{css:{color:"#eee"}},yGrids:{css:{color:"#eee"}},yAxis:{css:{color:"#ccc"}},xAxis:{css:{color:"#ccc"}},xLabels:{css:{color:"#666","font-size":"12px"}},yLabels:{css:{color:"#666","font-size":"12px"}},tip:{css:{border:"1px solid {COLOR}"}}},"ks-chart-rainbow":{title:{content:"",css:{"text-align":"center","font-size":"16px","font-weight":"bold",color:"#666"},isShow:!0},subTitle:{content:"",css:{"text-align":"center","font-size":"12px",color:"#666"},isShow:!0},points:{attr:{stroke:"#fff",r:4,"stroke-width":1.5,fill:l},hoverAttr:{stroke:"#fff",r:5,fill:l,"stroke-width":0}},xGrids:{css:{color:"#eee"}},yGrids:{css:{color:"#eee"}},yAxis:{css:{color:"#ccc"}},xAxis:{css:{color:"#ccc"}},xLabels:{css:{color:"#666","font-size":"12px"}},yLabels:{css:{color:"#666","font-size":"12px"}},tip:{css:{border:"1px solid {COLOR}"}}}};return t}),KISSY.add("gallery/kcharts/1.3/scatterchart/cfg",function(){var l="ks-chart-",t=l+"default",e="{COLOR}";return{themeCls:t,autoRender:!0,title:{content:"",css:{"text-align":"center","font-size":"16px"},isShow:!0},colors:[],subTitle:{content:"",css:{"text-align":"center","font-size":"12px"},isShow:!0},points:{attr:{stroke:"#fff",r:4,"stroke-width":1.5,fill:e,opacity:.6},hoverAttr:{stroke:"#fff",r:5,fill:e,"stroke-width":0,opacity:1}},legend:{isShow:!1},xLabels:{isShow:!0,css:{color:"#666","font-size":"12px","white-space":"nowrap",position:"absolute"}},yLabels:{isShow:!0,css:{color:"#666","font-size":"12px","white-space":"nowrap",position:"absolute"}},xAxis:{isShow:!0,css:{zIndex:10}},yAxis:{isShow:!0,css:{zIndex:10},num:5},xGrids:{isShow:!0,css:{}},yGrids:{isShow:!0,css:{}},tip:{isShow:!0,clsName:"",template:"",css:{},offset:{x:0,y:0},boundryDetect:!0}}}),KISSY.add("gallery/kcharts/1.3/scatterchart/index",function(l,t,e,i,r,n,a,s,o,h,c,x,y,u,f){var d,p,v=l.all,g="ks-chart-",m=g+"default",_=g+"evtlayout",b=_+"-rects",w="{COLOR}",k={initializer:function(){var t=this,e=this.userConfig;if(t._cfg=e,t._cfg.zoomType="xy",a.prototype.init.call(t,t._cfg),t.chartType="scatterchart",t._$ctnNode[0]){t._finished=[],m=t._cfg.themeCls||f.themeCls,t._cfg=l.mix(l.clone(l.mix(f,x[m],void 0,void 0,!0)),t._cfg,void 0,void 0,!0),t.color=d=new o({themeCls:m}),t._cfg.colors.length>0&&d.removeAllColors();for(var i in t._cfg.colors)d.setColor(t._cfg.colors[i]);t._cfg.autoRender&&t.render(!0)}},processAttr:function(t,e){var i=l.clone(t);for(var r in i)i[r]&&"string"==typeof i[r]&&(i[r]=i[r].replace(w,e));return i},diffStocksSize:function(){var l=this,t=l._cfg.points.attr.r,e=l._datas.total,i=[];for(var r in e)i=i.concat(a.prototype.getArrayByKey.call(null,e[r].data,2));if(i.length)for(var r in l._points){var n=a.prototype.getArrayByKey.call(null,e[r].data,2);for(var s in l._points[r])n.length>0&&(l._points[r][s].r=n[s]*t)}else for(var r in l._points)for(var s in l._points[r])l._points[r][s].r=t},drawAllStocks:function(){var l=this;l._stocks={_stocks:[]};for(var t in l._points)l._stocks[t]={stocks:l.drawStocks(t)}},drawStocks:function(l){var t=this,e=[],i=t.color.getColor(l).DEFAULT;for(var r in t._points[l]){var n=t._points[l][r];e[r]=t.drawStock(n.x,n.y,n.r,{stroke:i,fill:i,r:n.r})}return e},drawStock:function(l,t,e,i){var r=this,n=r.paper,a=r._cfg.points.attr;return n.circle(l,t,e,i).attr(a).attr(i)},renderTip:function(){if(this._cfg.tip.isShow){var t=this,e=t._cfg,i=t._innerContainer,r=e.tip.boundryDetect?{x:i.tl.x,y:i.tl.y,width:i.width,height:i.height}:{},n=l.mix(e.tip,{rootNode:t._$ctnNode,clsName:e.themeCls,boundry:r});return t.tip=new u(n),t.tip}},renderEvtLayout:function(){var l,t=this,e=t._cfg,i=t._innerContainer,r=(i.tl.y,i.height),n=t._evtEls._rects=[];l=t._evtEls.paper?t._evtEls.paper:t._evtEls.paper=new h(t._$ctnNode,{clsName:_,prependTo:!1,width:i.width,height:r,left:i.tl.x,top:i.tl.y,css:{"z-index":20,background:"#fff",filter:"alpha(opacity =1)","-moz-opacity":.01,"-khtml-opacity":.01,opacity:.01}});for(var a in t._points){var n=[];for(var s in t._points[a]){var o=2*(t._points[a][s].r||e.points.attr.r);n[s]=l.rect(t._points[a][s].x-o/2,t._points[a][s].y-o/2,o,o).attr({line_index:a,index:s}).addClass(b)}t._evtEls._rects[a]=n}},fix2Resize:function(){var t=this;t._$ctnNode,t._cfg.anim="";var e=l.buffer(function(){t.init()},200);!t.__isFix2Resize&&t.on("resize",function(){t.__isFix2Resize=1,e()})},clearEvtLayout:function(){var l=this;if(l._evtEls._rects)for(var t in l._evtEls._rects)for(var e in l._evtEls._rects[t])l._evtEls._rects[t][e].remove()},renderLegend:function(){if(this._cfg.legend.isShow){var t=this,e=t._cfg.legend,i=e.container&&v(e.container)[0]?v(e.container):t._$ctnNode,r=t._innerContainer,n=t.color._colors,a=n.length,s=t._cfg,o=t._cfg.series,h=l.map(o,function(l,t){t%=a;var e={},i=n[t];return e.text=l.text,e.DEFAULT=i.DEFAULT,e.HOVER=i.HOVER,e}),x=l.merge({interval:20,iconright:5,showicon:!0},s.legend.globalConfig);return t.legend=new c({container:i,paper:t.paper,bbox:{width:r.width,height:r.height,left:r.x,top:r.y},align:s.legend.align||"bc",offset:s.legend.offset||[0,30],globalConfig:x,config:h}),t.legend.on("click",function(l){var t=l.index,e=(l.text,l.icon,l.el);1!=e.hide?(this.hidePoints(t),e.hide=1,e.disable()):(this.showPoints(t),e.hide=0,e.enable())},this),t.legend}},showPoints:function(t){var e=this;a.prototype.recoveryData.call(e,t),e._clonePoints[t]=e._points[t],a.Common.animateGridsAndLabels.call(null,e),e.animateSiblingsPoints(t),e.diffStocksSize(),e._stocks[t]={stocks:e.drawStocks(t)},e.clearEvtLayout(),e.renderEvtLayout(),e.bindEvt(),l.log(e)},hidePoints:function(l){var t=this;a.prototype.removeData.call(t,l),delete t._clonePoints[l],a.Common.animateGridsAndLabels.call(null,t);for(var e in t._stocks[l].stocks)t._stocks[l].stocks[e].remove();t.animateSiblingsPoints(l),t.clearEvtLayout(),t.renderEvtLayout(),t.bindEvt()},animateSiblingsPoints:function(l){var t=this;for(var e in t._stocks)if(l!=e)for(var i in t._stocks[e].stocks)t._points[e]&&t._stocks[e].stocks[i].animate({cx:t._points[e][i].x,cy:t._points[e][i].y},400)},render:function(t){var e=this,i=e._cfg,r=i.themeCls;t&&e._$ctnNode.html(""),e.paper=s(e._$ctnNode[0],i.width,i.height,{position:"absolute"}),e.htmlPaper=new h(e._$ctnNode,{clsName:r}),e._clonePoints=e._points,a.Common.drawTitle.call(null,this,r),a.Common.drawSubTitle.call(null,this,r),e.renderTip(),a.Common.drawGridsX.call(null,this),a.Common.drawGridsY.call(null,this),a.Common.drawAxisX.call(null,this),a.Common.drawAxisY.call(null,this),a.Common.drawLabelsX.call(null,this),a.Common.drawLabelsY.call(null,this),e.diffStocksSize(),e.drawAllStocks(),e.renderLegend(),e.renderEvtLayout(),e.afterRender(),e.fix2Resize(),e.bindEvt(),l.log(e)},bindEvt:function(){var t=this,e=t._evtEls;l.clone(t._cfg.points.hoverAttr),r.detach(v("."+b,v("."+_,t._$ctnNode)),"mouseenter"),r.on(v("."+b,v("."+_,t._$ctnNode)),"mouseenter",function(l){var e=v(l.currentTarget),i=e.attr("index"),r=e.attr("line_index");t._points[r][i].dataInfo&&(t.stockChange(r,i),t._cfg.tip.isShow&&t.tipHandler(r,i))}),r.detach(e.paper.$paper,"mouseleave"),r.on(e.paper.$paper,"mouseleave",function(){t.tip&&t.tip.hide(),t.paperLeave()})},stockChange:function(l,t){var e=this,i=e._stocks[l],r={target:i.stocks[t],currentTarget:i.stocks[t],lineIndex:Math.round(l),stockIndex:Math.round(t)};e.fire("stockChange",r)},tipHandler:function(t,e){var i,r,n=this,a=n.color.getColor(t).DEFAULT,s=n.tip,o=n._cfg,h=o.tip.template,c=s.getInstance();h&&(i=n._points[t][e].dataInfo,l.isFunction(h)?s.setContent(h(i)):s.renderTemplate(h,i),r=n._points[t][e],s.isVisable()?s.animateTo(r.x,r.y):s.moveTo(r.x,r.y),c.css(n.processAttr(o.tip.css,a)))},paperLeave:function(){var l=this;l.fire("paperLeave",l)},afterRender:function(){var l=this;l.fire("afterRender",l)},getHtmlPaper:function(){return this.htmlPaper},getRaphaelPaper:function(){return this.paper},clear:function(){this._$ctnNode.html("")}};return t.extend?p=a.extend(k):(p=function(l){this.userConfig=l,this.initializer()},l.extend(p,a,k)),p},{requires:["base","node","dom","event","gallery/template/1.0/index","gallery/kcharts/1.3/basechart/index","gallery/kcharts/1.3/raphael/index","gallery/kcharts/1.3/tools/color/index","gallery/kcharts/1.3/tools/htmlpaper/index","gallery/kcharts/1.3/legend/index","./theme","gallery/kcharts/1.3/tools/touch/index","gallery/kcharts/1.3/tip/index","./cfg"]});