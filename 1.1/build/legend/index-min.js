KISSY.add("gallery/kcharts/1.1/legend/index",function(c,f,g,e,i,b){var d=c.all,h=c.Event;function a(j){var k=this;k._cfg=c.mix({themeCls:"ks-charts-legend",css:{},evtBind:false},j);k.init()}c.augment(a,{init:function(){var k=this,j=k._cfg;if(j.container){k.$ctn=d(j.container);if(!k.$ctn[0]){return}}k.render()},render:function(){var k=this,j=k._cfg,m=j.chart,l=m._innerContainer;k.renderIconContainer();k.$legend=d("."+j.themeCls,k.$ctn);k.renderIcon();k.$legend.css({marginLeft:l.width,marginTop:0}).css(j.css);j.evtBind&&m.on("afterRender",function(){k.bindEvt()});c.log(k)},renderIcon:function(){var r=this,q=r._cfg,o=q.chart,p=o.chartType,l,j,m,n=8,k=5;if(p=="linechart"){d(".legend-icon",r.$legend).each(function(u,s){var t=o._stocks[s];l=t.color;j=g(this[0]);m=t.type;j.path("M0,5L16,5").attr({stroke:l.DEFAULT,"stroke-width":2});switch(m){case"triangle":$stock=i.triangle(j,n,k+1,5);break;case"rhomb":$stock=i.rhomb(j,n,k,8,8);break;case"square":$stock=i.rhomb(j,n,k,8,8,45);break;default:$stock=j.circle(n,k,3);break}$stock.attr({fill:l.DEFAULT,stroke:l.DEFAULT})})}else{d(".legend-icon",r.$legend).each(function(t,s){l=o.color.getColor(s);j=g(this[0]);j.rect(0,0,10,8,2).attr({fill:l.DEFAULT,"stroke-width":"0px"})})}},renderIconContainer:function(){var l=this,k=l._cfg,n=k.chart;l._html="<div class="+k.themeCls+"><ul>";for(var m in n._datas.total){var j=n._cfg.series[m]["isShow"]==false?"clearfix disable":"clearfix";l._html+=e("<li class="+j+"><div class='legend-icon'></div><div class='legend-text'>{{text}}</div></li>").render(n._cfg.series[m])}l._html+="</ul></div>";d(l._html).appendTo(l.$ctn);return l._html},destroy:function(){var j=this;h.detach(d("li",_cfg.container),"click");j.$ctn.html("")},bindEvt:function(){var l=this,k=l._cfg,n=k.chart,m=n.chartType,j=l.$ctn;h.on(d("li",j),"click",function(p){var q=d(p.currentTarget).toggleClass("disable"),o=c.indexOf(p.currentTarget,d("li",j));if(!q.hasClass("disable")){"linechart"===m&&n.showLine(o);"barchart"===m&&n.showBar(o);"scatterchart"===m&&n.showPoints(o)}else{"linechart"===m&&n.hideLine(o);"barchart"===m&&n.hideBar(o);"scatterchart"===m&&n.hidePoints(o)}});h.on(d("li",j),"mouseenter",function(p){var q=d(p.currentTarget),o=c.indexOf(p.currentTarget,d("li",j));if(!q.hasClass("disable")){"linechart"===m&&n.lineChangeTo(o)}})}});return a},{requires:["gallery/kcharts/1.1/tools/htmlpaper/index","gallery/kcharts/1.1/raphael/index","gallery/template/1.0/index","gallery/kcharts/1.1/tools/graphtool/index","./assets/legend.css"]});
