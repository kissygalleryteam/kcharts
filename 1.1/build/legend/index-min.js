KISSY.add("gallery/kcharts/1.1/legend/index",function(f,l,n,k,p){function m(a){this._cfg=f.mix({themeCls:"ks-charts-legend",css:{},x:0,y:0,layout:"horizontal",align:"center",verticalAlign:"bottom",evtBind:!1},a);this.init()}var e=f.all,h=f.Event;f.augment(m,{init:function(){var a=this._cfg;if(a.container&&(this.$ctn=e(a.container),!this.$ctn[0]))return;this.render()},render:function(){var a=this,c=a._cfg,d=c.chart;a.renderIconContainer();a.renderIcon();a.setStyle();c.evtBind&&d.on("afterRender",function(){a.bindEvt()});
f.log(a)},setStyle:function(){var a=this._cfg,c=a.x,d=a.y,b=a.align,g=a.verticalAlign,e=this.$legend.outerWidth()||this.$legend.width(),f=this.$legend.outerHeight()||this.$legend.height(),k=this.filterPx(this.$ctn.width()),h=this.filterPx(this.$ctn.height());switch(b){case "left":b=0;break;case "center":b=k/2-e/2;break;default:b=k-e}switch(g){case "bottom":g=h-f;break;case "middle":g=h/2-f/2;break;default:g=0}g+=this.filterPx(d);b+=this.filterPx(c);this.$legend.css({marginLeft:b,marginTop:g}).css(a.css)},
filterPx:function(a){return!a?"":(a+"").replace("px","")-0},renderIcon:function(){var a=this._cfg.chart,c,d,b;"linechart"==a.chartType?e(".legend-icon",this.$legend).each(function(e,f){var h=a._stocks[f];c=h.color;d=l(this[0]);b=h.type;d.path("M0,5L16,5").attr({stroke:c.DEFAULT,"stroke-width":2});switch(b){case "triangle":$stock=k.triangle(d,8,6,5);break;case "rhomb":$stock=k.rhomb(d,8,5,8,8);break;case "square":$stock=k.rhomb(d,8,5,8,8,45);break;default:$stock=d.circle(8,5,3)}$stock.attr({fill:c.DEFAULT,
stroke:c.DEFAULT})}):e(".legend-icon",this.$legend).each(function(b,e){c=a.color.getColor(e);d=l(this[0]);d.rect(0,0,10,8,2).attr({fill:c.DEFAULT,"stroke-width":"0px"})})},renderIconContainer:function(){var a=this._cfg,c=a.chart;this._len=0;this._html="<div class='"+a.themeCls+" "+a.themeCls+"-"+a.layout+"'><ul>";for(var d in c._datas.total)this._len++,this._html+=n("<li class="+(!1==c._cfg.series[d].isShow?"clearfix disable":"clearfix")+"><div class='legend-icon'></div><div class='legend-text'>{{text}}</div></li>").render(c._cfg.series[d]);
this._html+="</ul></div>";this.$legend=e(this._html).appendTo(this.$ctn);return this._html},show:function(){return this.$legend.show()},destroy:function(){h.detach(e("li",_cfg.container),"click");this.$ctn.html("")},bindEvt:function(){var a=this._cfg.chart,c=a.chartType,d=this.$ctn;h.on(e("li",d),"click",function(b){var g=e(b.currentTarget).toggleClass("disable");b=f.indexOf(b.currentTarget,e("li",d));g.hasClass("disable")?("linechart"===c&&a.hideLine(b),"barchart"===c&&a.hideBar(b),"scatterchart"===
c&&a.hidePoints(b)):("linechart"===c&&a.showLine(b),"barchart"===c&&a.showBar(b),"scatterchart"===c&&a.showPoints(b))});h.on(e("li",d),"mouseenter",function(b){var g=e(b.currentTarget);b=f.indexOf(b.currentTarget,e("li",d));g.hasClass("disable")||"linechart"===c&&a.lineChangeTo(b)})}});return m},{requires:["gallery/kcharts/1.1/raphael/index","gallery/template/1.0/index","gallery/kcharts/1.1/tools/graphtool/index","./assets/legend.css"]});
