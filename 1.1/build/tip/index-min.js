KISSY.add("gallery/kcharts/1.1/tip/index",function(d,c,e,g){var f=d.all,a=d.Event;function b(h){if(!h){return}var j=this,i={clsName:"ks-chart-default",autoRender:true,isVisable:false,boundry:{x:0,y:0,width:0,height:0},rootNode:f("body"),tpl:"",corner:{isShow:false,tpl:"corner",css:{position:"absolute",marginLeft:0,marginTop:0}},anim:{easing:"easeOut",duration:0.25},offset:{x:0,y:0},alignX:"left",alignY:"top"};j._events={MOVE:"move",SETCONT:"setcontent",HIDE:"hide"};j._cfg=d.mix(i,h,g,g,true);j._cfg.rootNode=f(j._cfg.rootNode);j.init()}d.augment(b,c,{init:function(){var i=this,h=i._cfg;i._data={};i._tpl=h.tpl;i.$tip;i.bindEvent();if(h.autoRender){i.render()}},bindEvent:function(){var h=this,i=h._cfg.template,j=h._events;h.on(j.MOVE,function(m){var k=m.x,n=m.y,l=m.style;h.isVisable()?h.animateTo(k,n):h.moveTo(k,n);l&&h.$tip.css(l)});h.on(j.SETCONT,function(k){if(d.isFunction(i)){h.setContent(i(k.data))}else{h.renderTemplate(i,k.data)}});h.on(j.HIDE,function(k){h.hide()})},getInstance:function(){return this.$tip},isVisable:function(){return this.$tip.css("display")=="none"?false:true},show:function(){var h=this;h.$tip&&h.$tip.show();return h},hide:function(){var h=this;h.$tip&&h.$tip.stop()&&h.$tip.hide();return h},moveTo:function(p,m){var q=this;q.show();var l=q.getInstance(),o=q._cfg,j=q._cfg.anim,n=q.getPos(p,m),h=o.corner.css["margin-top"]||o.corner.css.marginTop||0,i=o.corner.css["margin-left"]||o.corner.css.marginLeft||0,k=q.$corner;k&&k.css({"margin-left":i+p-n.x});l.css({"margin-top":n.y,"margin-left":n.x})},animateTo:function(p,m,q){var r=this;r.show();var l=r.getInstance(),o=r._cfg,j=o.anim,n=r.getPos(p,m),h=o.corner.css["margin-top"]||o.corner.css.marginTop||0,i=o.corner.css["margin-left"]||o.corner.css.marginLeft||0,k=r.$corner;k&&k.css({"margin-left":i+p-n.x});l.stop().animate({"margin-top":n.y,"margin-left":n.x},j.duration,j.easing,function(){q&&q()})},renderTemplate:function(h,i){return this.setContent(e(h).render(i))},setContent:function(h){return f("."+this._cfg.clsName+"-tip-content",this.$tip).html(h)},getPos:function(v,t){var B=this,u=B._cfg,o=u.offset,j=t+o.y,m=v+o.x,n=u.alignX,k=u.alignY,p=B.getInstance(),i=p.outerWidth(),A=p.outerHeight(),l=u.boundry;B.set("x",v||0);B.set("y",t||0);switch(n){case"center":m=Math.round(v)+o.x-i/2;break;case"right":m=Math.round(v)+o.x-i;break}switch(k){case"middle":j=Math.round(t)+o.y-A/2;break;case"bottom":j=Math.round(t)+o.y-A;break}if(l.width&&l.height){var s=l.x||0,r=l.y||0,z=l.width,q=l.height;if(j<r){j=t-(-Math.abs(o.y))}else{if(j>r+q-A){j=t-A-Math.abs(o.y)}}if(m<s){m=v-(-Math.abs(o.x))}else{if(m>s+z-i){m=v-i-Math.abs(o.x)}}}return{x:m,y:j}},_isExist:function(){return this.$tip&&this.$tip[0]},render:function(){var i=this,h=i._cfg,j=i._tpl,k=i._data,l=h.isVisable?"inline-block":"none",m=h.rootNode.offset();if(!h.rootNode.offset()){return}i.$tip=!i._isExist()&&f('<span class="'+h.clsName+'-tip" style="*zoom:1;"><span class="'+h.clsName+'-tip-content"></span></span>').css({display:l}).appendTo(h.rootNode);i.$corner=(h.corner.isShow&&h.corner.tpl)?f("<div class='"+h.clsName+"-corner'>"+h.corner.tpl+"</div>").css(h.corner.css).appendTo(i.$tip):g;i.$tip.css({"margin-top":m.top+h.offset.y,"margin-left":m.left+h.offset.x,position:"absolute"});i.renderTemplate(j,k);return i.$tip}});return b},{requires:["base","gallery/template/1.0/index","./assets/tip.css"]});
